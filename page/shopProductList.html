 
<!DOCTYPE HTML>
<html>
    <head>
         <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0">
        <title> 商品列表</title>
        
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script type="text/javascript" src="../js/request.js"></script>
        <script type="text/javascript" src="../js/base.js"></script>
        <script type="text/javascript" src="../js/userData.js"></script>
        <link rel="stylesheet" type="text/css" href="../css/style.css"/>
    </head>

    <body>
        <div style="height:40px;">
             <button onclick="addAction()" style="float:right;margin-top: 5px;height: 30px;color: #333333;font-size: 16px;width: 100px;">添加商品</button>
        </div>
        <div id ="list" style="width:100%;margin-top:10px;">
        </div>    

        <script>
    
             window.onload = function(){
                if ( sp_checkLogin(true) == true){
                    productList();
                }
            }

            function productList(){
                shopProductListRequest(JSON.stringify({"user_id":getUserId()}),function(data){
                    var code = data.code; 
                    var listData = data.data; 
                    var list = listData.list; 
                    if (code == "0"){
                        var div = '<table border="1" cellspacing="0" cellpadding="0" style="width:100%;border:solid #eee">'; 
                        div += '<tr style="height:44px;">\
                                    <th style="width:40%">名称</th>\
                                    <th style="width:20%">价格</th>\
                                    <th style="width:20%">库存</th>\
                                    <th style="width:20%"> </th>\
                                </tr>'
                        for (i in  list){
                            var listDic = list[i];
                            var id = listDic.id; 
                            div += '<tr style="height:44px;">\
                                         <td style="margin-left:10px;padding-left: 5px;">'+changeText(listDic.title)+'</td>\
                                         <td style="text-align: center;">'+changeText(listDic.price)+'</td>\
                                         <td style="text-align: center;">'+changeText(listDic.stock)+'</td>\
                                         <td> <button onclick=editAction("'+id+'") style="margin-left:10px;width:100px;">编辑</button>  <button onclick=deleteAction("'+id+'") style="margin-left:10px;width:100px;">删除</button> </td>\
                                    </tr>'
                        }
                        div += "</table>"
                        $("#list").append(div); 
                       
                    }
                }); 
            }
            function editAction(e){
                if (window != top){
                    top.location.href = 'addProduct.html?id='+e;
                }else{
                    window.location.href = 'addProduct.html?id='+e;
                }
               
            }
            function deleteAction(e){
                console.log(e); 
                var mymessage = confirm("是否删除商品  ?");
                if (mymessage==true) {
                    console.log("点击确定");
                     delProduct(JSON.stringify({"id":e}),function (responseData){
                        console.log(responseData);
                        alert(responseData.message);
                        sp_reload(); 
                     }); 
                }else{
                    console.log("点击取消");
                }
            }
             function addAction(){
                 if (window != top){
                    top.location.href = 'addProduct.html';
                 }else{
                    window.location.href = 'addProduct.html';
                 }
            }
            function lookAction(){
                if (window != top){
                    top.location.href = 'shopProductDet.html?id='+e;
                }else{
                    window.location.href = 'shopProductDet.html?id='+e;
                }
            }

        </script>

    </body>
    </html>